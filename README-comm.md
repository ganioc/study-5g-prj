# 通信之道
从第9章，基本通信链路，开始，

基本的无线通信链路，声音信号转换为电信号，这个电信号被调制到一个载波频率$f_c=\frac{w_c}{2\pi}$上，通过发射天线发射出去。接收放的天线接收到这个信号后，再通过解调器把它转换成电信号，驱动喇叭发出声音。

发射方有两个核心部件，modulator, Tx antenna;接收方也有两个核心部件Rx antenna和Demodulator.
无线通信是以电磁波为载体的，天线的作用是发射和接收电磁波。

法拉第，赫兹，麦克斯韦

## 调制-频谱搬移
假定$s(t)$是一个余弦信号
$$
s(t) = \cos{wt}
$$
调制就是乘上一个角频率为$w_c = 2\pi f_c$的余弦信号，得到要发射的射频信号
$$
s_{RF}(t) = s(t) \cos{w_ct}= \cos{wt}\cos{w_ct} \\[0.5em]
= \frac{\cos{（w_c- w)t} + \cos{(w_c +w)t}}{2}
$$

### 9.3 相干解调
在解调器当中，用一个载波信号$\cos{w_ct}$乘以接收到的信号，得到
$$
\cos{wt}\cos^2{w_ct} = \cos{wt}(\cos{(2w_ct +1)}/2) \\
= s(t)/2 + \cos{wt} \cos{2w_ct}/2
$$
解调后的信号包括了一个低频信号$s(t)$和一个高频信号$\cos{wt}\cos{2w_ct}$,用一个低频滤波器把高频信号成分滤掉，就得到了要传递的基带信号$s(t)$

对于一个一般性的基带信号$s(t)$, 假设其频谱为
$$
\textcolor{blue}{基带信号}  \\
S(w) = F{\lbrace s(t) \rbrace}
$$
载波的频谱为
$$
F\lbrace \cos{(w_ct)} \rbrace = \pi \delta(w - w_c) + \pi \delta(w + w_c)
$$
则已调信号的频谱为
$$
\begin{aligned}
    S_RF(w) &= F\{ s(t) \cos{w_ct} \} \\
    &= \frac{1}{2\pi}S(w) * [ \pi\delta(w - w_c) + \pi\delta(w + w_c)] \\
    &= \frac{1}{2}[S(w-w_c) + S(w+w_c)]
\end{aligned}
$$
这个过程叫相干解调。

## 9.4 非相干解调
也称为包络检测技术，但是使用这一技术要求基带信号为非负，这可以通过在原基带信号当中叠加一个直流信号实现
例如，非负基带信号$s(t)=2 + \cos{(wt)}$
经过调制后的信号为$S_RF(t) = s(t)\cos{(w_ct)}$
因为基带信号是非负的，所以已调信号的包络就是基带信号

## 9.5 载波恢复
载波恢复就是从接收到的信号当中恢复出载波信号。知道了载波的周期和相位，也就恢复了载波信号。

载波信号恢复时存在$\pi$的相位模糊，也就是说，把载波移动相位$\pi$,或者加一个负号也是可以的。

推导公式要有方向，这个方向来自于直觉，来自于对问题的宏观把握。

## 9.6 锁相环
锁相环是相干解调当中用到的关键部位，包括了3个关键部件，鉴相器，环路滤波器和压控振荡器。

假设VCO的输出信号是一个余弦函数:
$$
c(t) = \cos{[\theta(t)]}
$$
其中香味函数表示为
$$
\theta{(t)} = 2\pi f_0t + \hat\phi(t)=2\pi f_0 t + K\int_{-\infin}^{t}u_c(\tau)d\tau
$$
$\theta(t)$对$t$的导数就是瞬时角频率
$$
w(t) = \frac{d}{dt}\theta(t)=2\pi f_0 + Kv
$$
这样就实现了用输入电压来控制频率
如果输入电压$u_c(t)$是一个设么形状的波形，由于积分的作用，$\theta(t)$总是一个连续函数，不会出现跳变。所以$c(t)$的波形也总是连续的。

关于锁相环的系统特性、数字锁相环等，可以参考更加专业的书籍

## 9.7 平方环
由于$s^{2}(t)$是非负信号，而且对于载波$f_c$来说是一个慢变信号，它的作用可以合并到VCO的控制灵敏度里面。VCO通过稍稍改变锁定后的相差就可以跟随驱动信号幅度的变化，因此数据信息对锁相环的影响不大。

## 9.8 Costas环

## 9.9 双边带信号
## 9.10 单边带信号
## 9.11 Hilbert变换
做一个定义
$$
\hat{s(t)} = s(t)*\frac{1}{\pi t} = \frac{1}{\pi}\int_{-\infin}^{\infin}\frac{s(\tau)}{t-\tau}d\tau
$$
信号$\hat{s(t)}$可以认为是信号$s(t)$经过一个系统后的响应，这个系统的冲激响应为
$$
h(t) = \frac{1}{\pi t}
$$
这个系统被称为希尔伯特变换，这是一个非因果系统,
希尔伯特变换的频域特性为
$$
H(w) = \begin{cases}
    -j, \space w>0 \\
    0, \space w=0 \\
    j , \space w<0 \\
\end{cases}
$$
从如下公式可以直接计算希尔伯特变换的频率特性
$$
H(w) = \int_{-\infin}^{\infin}h(t)e^{-jwt}dt = \int_{-\infin}^{\infin}\frac{1}{t} e^{-jwt}dt
$$
从频域特性来看，除直流外，希尔伯特变换的幅值恒定为1，而对正频率移相$-\frac{\pi}{2}$,对负频率移相$\frac{\pi}{2}$

从一个双边信号$s(t)$,通过如下的方式就可以得到一个单边带信号
$$
s_+(t) = s(t) + j\hat{s}(t)
$$
从而节省一半的带宽
我们发现，单边带信号是一个复数，如何产生一个复数信号呢?

## 9.12 单边带信号的发送和接收
单边带信号, $s_+(t) = s(t) + j\hat{s}(t)$
其中$\hat{s}(t)$是$s(t)$的希尔伯特变换

我们来回忆一下复数的概念，一个复数$x+jy$和一个实数对$(x,y)$相对应，也就是说，一个实数对就可以表达一个复数，只不过还需进一步满足四则运算的要求。

射频的单边带信号
$$
s_{RF+}(t) = [s(t) + j\hat{s}(t)]\cos{(w_ct)}
$$
但是它的虚部和实部多事双边带信号。只要载波信号是实数，我们就无法看出如何表示和发射这个信号。

我们采用复数的载波信号。只要载波信号的傅里叶变换具有冲激函数的性质，就可以保持基带信号的单边带特征。这个合适的复数载波信号就是复指数函数
$$
e^{jw_ct} = \cos{(w_ct)} + j\sin{(w_ct)}
$$
其傅里叶变换为
$$
F[e^{jw_ct}] = \delta{(w_c)}
$$
我们用复指数信号为载波，得到一个单边带的已调信号。为了符号的简便，我们还是采用符号$s_{RF+}(t)$来表示，
$$
\begin{aligned}
s_{RF+}(t) &= [s(t) + j\hat{s}(t)]e^{jw_ct} \\
&= [s(t) + j\hat{s}(t)][\cos{(w_ct)} + j\sin{(w_ct)}] \\
&= s(t)\cos{(w_ct)} - \hat{s}(t)\sin{(w_ct)} + j[\hat{s}(t)\cos{(w_ct)} + s(t) \sin{(w_ct)}]
\end{aligned}
$$
看它的实部的频谱
$$
F\{ \Reals [s_{RF+}(t)] \} = F[s(t)\cos{(w_ct)} - \hat{s}(t)\sin{(w_ct)}] \\
= S(w)*\frac{\delta(w_c) + \delta(-w_c)}{2} - S(w)H(w)*\frac{\delta(w_c) -\delta(-w_c)}{2j} \\
= \frac{1}{2}S(w)[1+jH(w)]*\delta(w_c) + \frac{1}{2}S(w)[1-jH(w)]*\delta(-w_c) \\
$$
设$S_{+}(w)=S(w)[1+jH(w)], s_{-}(w)[1-jH(w)]$, 分别是 $S(w)$的上边带和下边带，可以看出实部的频谱是单边带的。

$$
F\{ \Reals [s_{RF+}(t)] \} = \frac{S_{+}(w)}{2}*\delta(w_c) + \frac{S_{-}(w)}{2}*\delta(-w_c) \\
= \frac{S_{+}(w + w_c) + S_{-}(w-w_c)}{2}
$$

同样的道理，虚部的频谱也是单边带的
$$
F\{ \Im[s_{RF+}(t)] \} = \frac{S_+(w+w_c) - S_{-}(w-w_c)}{2j}
$$
虚部频谱的模与实部是相同的

这样的话，我们就找到了单边带信号的发射方案，只要发射实部或者虚部就可以了。习惯上，我们一般采用实部。

解调的方法还是乘以$\cos{(w_ct)}$

## 9.13 思考一下
提出问题的时候，问题差不多已经解决了。提出问题和解决问题是一个并行的过程，对所有的结论保持一个合理的怀疑。研究的过程就是探究竟，起怀疑，如果怀疑错了就继续研究。直到有一天，运气好，你的怀疑对了，也就创新了。怎样知道怀疑对了呢？因为你已经把问题解决了。

单边带信号$s(t)\cos{(w_ct)} - \hat{s}(t)\sin{(w_ct)}$,同时利用了载波的幅度和相位，而双边带信号只利用了载波的幅度。双边带信号只利用了余弦分量，而单边带信号同时利用了正弦和余弦两个正交分量。单边带信号利用了多一倍的信息，所以只需要一半的频谱资源。

但是如果我们独立地设置正弦和余弦分量，虽然带宽仍然和双边带信号相同，但是传递的信息也增加了一倍，频谱效率和单边带信号是相同的，而且省掉了希尔伯特变换这个环节。这个方法就是目前普遍采用了的IQ调制技术。

$x(t)\cos{(w_ct)} - y(t)\sin{(w_ct)}$

接收端乘以$\cos{(w_ct)}$，得到
$$
x(t)\cos^{2}(w_ct) - y(t)\sin{(w_ct)}\cos{(w_ct)}=x(t)\frac{1+\cos{(2w_ct)}}{2} - y(t)\frac{\sin{(2wct)}}{2}
$$
接收端乘以$-\sin{(w_ct)}$,得到
$$
-x(t)\sin{(w_ct)}\cos{(w_ct)} + y(t)\sin^2(w_ct)=-x(t)\frac{\sin{(2w_ct)}}{2 } + y(t)\frac{1-\cos{(2w_ct)}}{2}
$$
滤掉倍频成分后，分别得到了$x(t)$和$y(t)$

## 9.15 IQ信号的复数表达
已知关系
$$
[x(t)+jy(t)]e^{jw_ct} = x(t)\cos{(w_ct)} - y(t)\sin{(w_ct)} \\ 
+ j[y(t)\cos{(w_ct)} + x(t)\sin{(w_ct)}]
$$
IQ调制信号的发射，实际上就是这个复信号的实部。实部和虚部是一一对应的。我们可以把IQ信号看成是复数信号。

复数信号是等价的数学表达，实数信号是实际的发射和接收过程。

任意一个实信号$s_{RF}(t)$都可以写成以下形式
$$
s_{RF}(t) = \Reals{[s(t)e^{jw_ct}]}
$$
其中$s(t)=x(t) + jy(t)$,是一个复数信号。
假设这个关系成立，找出这个$s(t)$该是什么样的信号? 取实部的话，对于复数来说等于$1/2$复数+复数共轭
$$
s_{RF}(t) = \frac{1}{2}[s(t)e^{jw_ct} + s^{*}(t)e^{-jw_ct}]
$$
做傅里叶变换，得到
$$
S_{RF}(w) = \frac{1}{2}[S(w-w_c) + S^{*}(-w - w_c)]
$$
其中$S(w)=F[s(t)]$
因为$s_{RF}(t)$是实信号，所以其频谱有对称性
$$
S^{*}_{RF}(-w) = S_{RF}(w)
$$
注意到这样的对称性，$S(w)$就是这样一种形式:
$$
S(w-w_c)=\begin{cases}
    0, \space w<0 \\
    S_{RF}(w), \space w=0 \\
    2S_{RF}(w), \space w > 0 \\
\end{cases}
$$

$$
S(w) = \begin{cases}
    0, \space w<-w_c \\
    S_{RF}(w), \space w= -w_c \\
    2S_{RF}(w), \space w > -w_c \\
\end{cases}
$$

在无线通信中，我们把基带信号调制到一个载波上，就形成了一个带通信号。接收机收到的是带通信号和信道的冲激响应的卷积
$$
r_{RF}(t) = s_{RF}(t) * h_{RF}(t)
$$
在频域上
$$
R_{RF}(w) = S_{RF}(w)H_{RF}(w)
$$
表达为形式







